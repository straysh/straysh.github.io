<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css" />
  
  
  <title>使用Go操作文件 | Hexo</title>
  <meta name="description" content="一切皆文件UNIX世界的一个基石观点是一切皆文件。我们不需要知道文件描述符映射的，由操作系统的设备驱动抽象出来的是什么。操作系统以文件的形式向我们提供了访问设备的接口。 Go语言中的读&#x2F;写接口也类似。我们仅仅简单的读&#x2F;写字节，并不需要理解reader从何处及如何读数据，或者writer将数据写入到了何处。在&#x2F;dev下能找到可用的设备。有些可能需要提权访问。 1. 基础文件操作1.1 创建空文件12">
<meta property="og:type" content="article">
<meta property="og:title" content="使用Go操作文件">
<meta property="og:url" content="https://straysh.github.life/2022/03/14/%E4%BD%BF%E7%94%A8Go%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/index.html">
<meta property="og:site_name" content="Straysh的小院">
<meta property="og:description" content="一切皆文件UNIX世界的一个基石观点是一切皆文件。我们不需要知道文件描述符映射的，由操作系统的设备驱动抽象出来的是什么。操作系统以文件的形式向我们提供了访问设备的接口。 Go语言中的读&#x2F;写接口也类似。我们仅仅简单的读&#x2F;写字节，并不需要理解reader从何处及如何读数据，或者writer将数据写入到了何处。在&#x2F;dev下能找到可用的设备。有些可能需要提权访问。 1. 基础文件操作1.1 创建空文件12">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://straysh.github.life/images/golang/go_files.png">
<meta property="article:published_time" content="2022-03-14T12:11:25.000Z">
<meta property="article:modified_time" content="2022-03-15T02:23:23.963Z">
<meta property="article:author" content="Straysh">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://straysh.github.life/images/golang/go_files.png">
  <!-- Canonical links -->
  <link rel="canonical" href="https://straysh.github.life/2022/03/14/%E4%BD%BF%E7%94%A8Go%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Straysh的小院" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
  
  
    <link href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css" rel="stylesheet">
  
  
<meta name="generator" content="Hexo 5.4.1"></head>


<body class="main-center theme-green" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" style="background-image: url(/images/left_images/2.jpg);" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent" style="height:100%;background-color: rgba(0,0,0,0.7);">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://hexo.straysh.com" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">Straysh</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">野生程序猿</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Beijing, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">项目</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="/books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">书单</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/straysh" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/u/1689171115" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">

    
      <ul class="sidebar-nav motion-element" style="text-align:center; opacity: 1; display: block; transform: translateX(0px);">
        <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
          文章目录
        </li>
        <li class="sidebar-nav-overview" data-target="site-overview-wrap">
          系统目录
        </li>
      </ul>
      <section class="site-overview-wrap sidebar-panel" style="opacity: 0; display: none;">
        
          <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>妳是风中的叶，风起而走，我想去追，怎么抓的住？</p>
            </div>
        </div>
    </div>
</div>

        
          
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%9A%E6%96%87/">博文</a><span class="category-list-count">102</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%9A%E6%96%87/%E7%AC%94%E8%AE%B0/">笔记</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%AE%B0/">杂记</a><span class="category-list-count">6</span></li></ul>
    </div>
  </div>


        
          
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache/" rel="tag">Apache</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Banbrick/" rel="tag">Banbrick</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang/" rel="tag">Golang</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javascript/" rel="tag">Javascript</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nodejs/" rel="tag">Nodejs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/R/" rel="tag">R</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SVN/" rel="tag">SVN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sphinx/" rel="tag">Sphinx</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Translation/" rel="tag">Translation</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yii/" rel="tag">Yii</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">杂</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B1%87%E7%BC%96/" rel="tag">汇编</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


        
          
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/Algorithm/" style="font-size: 13.67px;">Algorithm</a> <a href="/tags/Apache/" style="font-size: 13px;">Apache</a> <a href="/tags/Banbrick/" style="font-size: 13.33px;">Banbrick</a> <a href="/tags/Docker/" style="font-size: 13.22px;">Docker</a> <a href="/tags/Golang/" style="font-size: 14px;">Golang</a> <a href="/tags/Javascript/" style="font-size: 13.56px;">Javascript</a> <a href="/tags/Linux/" style="font-size: 13.67px;">Linux</a> <a href="/tags/MySQL/" style="font-size: 13.67px;">MySQL</a> <a href="/tags/Mysql/" style="font-size: 13px;">Mysql</a> <a href="/tags/Nginx/" style="font-size: 13.11px;">Nginx</a> <a href="/tags/Nodejs/" style="font-size: 13px;">Nodejs</a> <a href="/tags/PHP/" style="font-size: 13.89px;">PHP</a> <a href="/tags/R/" style="font-size: 13.11px;">R</a> <a href="/tags/Redis/" style="font-size: 13.11px;">Redis</a> <a href="/tags/SVN/" style="font-size: 13px;">SVN</a> <a href="/tags/Sphinx/" style="font-size: 13.33px;">Sphinx</a> <a href="/tags/Translation/" style="font-size: 13.78px;">Translation</a> <a href="/tags/Yii/" style="font-size: 13.11px;">Yii</a> <a href="/tags/%E6%9D%82/" style="font-size: 13.44px;">杂</a> <a href="/tags/%E6%B1%87%E7%BC%96/" style="font-size: 13px;">汇编</a>
    </div>
  </div>

        
          
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">26</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">十一月 2014</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">三月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">十二月 2013</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">九月 2013</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


        
          
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%8D%9A%E6%96%87/">博文</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E5%8D%9A%E6%96%87/%E7%AC%94%E8%AE%B0/">笔记</a>
              </p>
              <p class="item-title">
                <a href="/2022/03/14/%E4%BD%BF%E7%94%A8Go%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/" class="title">使用Go操作文件</a>
              </p>
              <p class="item-date">
                <time datetime="2022-03-14T12:11:25.000Z" itemprop="datePublished">2022-03-14</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%8D%9A%E6%96%87/">博文</a>
              </p>
              <p class="item-title">
                <a href="/2022/03/13/Docker%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C/" class="title">Docker容器网络</a>
              </p>
              <p class="item-date">
                <time datetime="2022-03-13T04:10:09.000Z" itemprop="datePublished">2022-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%8D%9A%E6%96%87/">博文</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E5%8D%9A%E6%96%87/%E7%AC%94%E8%AE%B0/">笔记</a>
              </p>
              <p class="item-title">
                <a href="/2022/03/13/Iptables%E5%92%8C%E5%AE%B9%E5%99%A8/" class="title">Iptables和容器</a>
              </p>
              <p class="item-date">
                <time datetime="2022-03-13T03:01:46.000Z" itemprop="datePublished">2022-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%8D%9A%E6%96%87/">博文</a>
              </p>
              <p class="item-title">
                <a href="/2022/03/12/Linux%E7%BD%91%E6%A1%A5%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/" class="title">Linux网桥工作原理</a>
              </p>
              <p class="item-date">
                <time datetime="2022-03-12T10:02:29.000Z" itemprop="datePublished">2022-03-12</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%8D%9A%E6%96%87/">博文</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/16/%E5%B9%B6%E5%8F%91%E5%92%8C%E8%B0%83%E5%BA%A6%E7%9A%84%E5%85%B3%E7%B3%BB/" class="title">并发和调度的关系</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-16T05:54:13.000Z" itemprop="datePublished">2021-03-16</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

        
      </section>

      <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active" style="opacity: 1; display: block;">
        <nav id="toc" class="article-toc">
          <h3 class="toc-title">文章目录</h3>
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E5%88%87%E7%9A%86%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">一切皆文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">2.</span> <span class="toc-text">1. 基础文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%88%9B%E5%BB%BA%E7%A9%BA%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 创建空文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E6%88%AA%E6%96%AD%E6%96%87%E4%BB%B6%EF%BC%88Truncate%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 截断文件（Truncate）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF"><span class="toc-number">2.3.</span> <span class="toc-text">1.3 获取文件信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E9%87%8D%E5%91%BD%E5%90%8D-%E7%A7%BB%E5%8A%A8%E6%96%87%E4%BB%B6"><span class="toc-number">2.4.</span> <span class="toc-text">1.4 重命名&#x2F;移动文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="toc-number">2.5.</span> <span class="toc-text">1.5 删除文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-%E6%89%93%E5%BC%80-%E5%85%B3%E9%97%AD%E6%96%87%E4%BB%B6"><span class="toc-number">2.6.</span> <span class="toc-text">## 1.6 打开&#x2F;关闭文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-%E6%A3%80%E6%9F%A5%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="toc-number">2.7.</span> <span class="toc-text">1.7 检查文件是否存在</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-8-%E6%A3%80%E6%9F%A5%E8%AF%BB-%E5%86%99%E6%9D%83%E9%99%90"><span class="toc-number">2.8.</span> <span class="toc-text">1.8 检查读&#x2F;写权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-9-%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90-%E6%8B%A5%E6%9C%89%E8%80%85-%E6%97%B6%E9%97%B4%E6%88%B3"><span class="toc-number">2.9.</span> <span class="toc-text">1.9 修改权限&#x2F;拥有者&#x2F;时间戳</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-10-%E5%88%9B%E5%BB%BA%E7%A1%AC%E9%93%BE%E6%8E%A5-%E8%BD%AF%E9%93%BE%E6%8E%A5"><span class="toc-number">2.10.</span> <span class="toc-text">1.10 创建硬链接&#x2F;软链接</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%BB-%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">读&#x2F;写文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 复制文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E8%B7%B3%E8%87%B3%E6%8C%87%E5%AE%9A%E4%BD%8D%E7%BD%AE%EF%BC%88Seek%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 跳至指定位置（Seek）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E5%90%91%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AD%97%E8%8A%82"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 向文件写入字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E5%BF%AB%E9%80%9F%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 快速写入文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E4%BD%BF%E7%94%A8%E7%BC%93%E5%86%B2%E5%86%99%EF%BC%88Buffered-Writer%EF%BC%89"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 使用缓冲写（Buffered Writer）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%A4%9A%E8%AF%BB%E6%96%87%E4%BB%B6%E7%9A%84n%E4%B8%AA%E5%AD%97%E8%8A%82"><span class="toc-number">3.6.</span> <span class="toc-text">最多读文件的n个字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-%E5%8F%AA%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E7%9A%84n%E4%B8%AA%E5%AD%97%E8%8A%82"><span class="toc-number">3.7.</span> <span class="toc-text">2.7 只读取文件的n个字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8-%E8%87%B3%E5%B0%91%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E7%9A%84n%E4%B8%AA%E5%AD%97%E8%8A%82"><span class="toc-number">3.8.</span> <span class="toc-text">2.8 至少读取文件的n个字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9-%E8%AF%BB%E6%96%87%E4%BB%B6%E7%9A%84%E5%85%A8%E9%83%A8%E5%AD%97%E8%8A%82"><span class="toc-number">3.9.</span> <span class="toc-text">2.9 读文件的全部字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10-%E5%BF%AB%E9%80%9F%E8%AF%BB%E5%8F%96%E5%85%A8%E9%83%A8%E6%96%87%E4%BB%B6%E5%88%B0%E5%86%85%E5%AD%98"><span class="toc-number">3.10.</span> <span class="toc-text">2.10 快速读取全部文件到内存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-11-%E4%BD%BF%E7%94%A8%E7%BC%93%E5%86%B2%E8%AF%BB%EF%BC%88Buffered-Reader%EF%BC%89"><span class="toc-number">3.11.</span> <span class="toc-text">2.11 使用缓冲读（Buffered Reader）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-12-%E4%BD%BF%E7%94%A8Scanner%E8%AF%BB"><span class="toc-number">3.12.</span> <span class="toc-text">2.12 使用Scanner读</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%BD%92%E6%A1%A3"><span class="toc-number">4.</span> <span class="toc-text">3. 归档</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-Zip%E5%BD%92%E6%A1%A3"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 Zip归档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-Zip%E8%A7%A3%E5%8E%8B"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 Zip解压</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%8E%8B%E7%BC%A9"><span class="toc-number">5.</span> <span class="toc-text">4. 压缩</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 文件压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E6%96%87%E4%BB%B6%E8%A7%A3%E5%8E%8B%E7%BC%A9"><span class="toc-number">5.2.</span> <span class="toc-text">4.1 文件解压缩</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C"><span class="toc-number">6.</span> <span class="toc-text">5. 其他操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95"><span class="toc-number">6.1.</span> <span class="toc-text">5.1 临时文件和目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E4%BB%8EHTTP%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6"><span class="toc-number">6.2.</span> <span class="toc-text">5.2 从HTTP下载文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E5%93%88%E5%B8%8C%E5%92%8C%E6%91%98%E8%A6%81%EF%BC%88Hashing%E5%92%8CChecksums%EF%BC%89"><span class="toc-number">6.3.</span> <span class="toc-text">5.3 哈希和摘要（Hashing和Checksums）</span></a></li></ol></li></ol>
        </nav>
      </section>
    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E5%88%87%E7%9A%86%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">一切皆文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">2.</span> <span class="toc-text">1. 基础文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%88%9B%E5%BB%BA%E7%A9%BA%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 创建空文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E6%88%AA%E6%96%AD%E6%96%87%E4%BB%B6%EF%BC%88Truncate%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 截断文件（Truncate）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF"><span class="toc-number">2.3.</span> <span class="toc-text">1.3 获取文件信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E9%87%8D%E5%91%BD%E5%90%8D-%E7%A7%BB%E5%8A%A8%E6%96%87%E4%BB%B6"><span class="toc-number">2.4.</span> <span class="toc-text">1.4 重命名&#x2F;移动文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="toc-number">2.5.</span> <span class="toc-text">1.5 删除文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-%E6%89%93%E5%BC%80-%E5%85%B3%E9%97%AD%E6%96%87%E4%BB%B6"><span class="toc-number">2.6.</span> <span class="toc-text">## 1.6 打开&#x2F;关闭文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-%E6%A3%80%E6%9F%A5%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="toc-number">2.7.</span> <span class="toc-text">1.7 检查文件是否存在</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-8-%E6%A3%80%E6%9F%A5%E8%AF%BB-%E5%86%99%E6%9D%83%E9%99%90"><span class="toc-number">2.8.</span> <span class="toc-text">1.8 检查读&#x2F;写权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-9-%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90-%E6%8B%A5%E6%9C%89%E8%80%85-%E6%97%B6%E9%97%B4%E6%88%B3"><span class="toc-number">2.9.</span> <span class="toc-text">1.9 修改权限&#x2F;拥有者&#x2F;时间戳</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-10-%E5%88%9B%E5%BB%BA%E7%A1%AC%E9%93%BE%E6%8E%A5-%E8%BD%AF%E9%93%BE%E6%8E%A5"><span class="toc-number">2.10.</span> <span class="toc-text">1.10 创建硬链接&#x2F;软链接</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%BB-%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">读&#x2F;写文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 复制文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E8%B7%B3%E8%87%B3%E6%8C%87%E5%AE%9A%E4%BD%8D%E7%BD%AE%EF%BC%88Seek%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 跳至指定位置（Seek）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E5%90%91%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AD%97%E8%8A%82"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 向文件写入字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E5%BF%AB%E9%80%9F%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 快速写入文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E4%BD%BF%E7%94%A8%E7%BC%93%E5%86%B2%E5%86%99%EF%BC%88Buffered-Writer%EF%BC%89"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 使用缓冲写（Buffered Writer）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%A4%9A%E8%AF%BB%E6%96%87%E4%BB%B6%E7%9A%84n%E4%B8%AA%E5%AD%97%E8%8A%82"><span class="toc-number">3.6.</span> <span class="toc-text">最多读文件的n个字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-%E5%8F%AA%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E7%9A%84n%E4%B8%AA%E5%AD%97%E8%8A%82"><span class="toc-number">3.7.</span> <span class="toc-text">2.7 只读取文件的n个字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8-%E8%87%B3%E5%B0%91%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E7%9A%84n%E4%B8%AA%E5%AD%97%E8%8A%82"><span class="toc-number">3.8.</span> <span class="toc-text">2.8 至少读取文件的n个字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9-%E8%AF%BB%E6%96%87%E4%BB%B6%E7%9A%84%E5%85%A8%E9%83%A8%E5%AD%97%E8%8A%82"><span class="toc-number">3.9.</span> <span class="toc-text">2.9 读文件的全部字节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10-%E5%BF%AB%E9%80%9F%E8%AF%BB%E5%8F%96%E5%85%A8%E9%83%A8%E6%96%87%E4%BB%B6%E5%88%B0%E5%86%85%E5%AD%98"><span class="toc-number">3.10.</span> <span class="toc-text">2.10 快速读取全部文件到内存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-11-%E4%BD%BF%E7%94%A8%E7%BC%93%E5%86%B2%E8%AF%BB%EF%BC%88Buffered-Reader%EF%BC%89"><span class="toc-number">3.11.</span> <span class="toc-text">2.11 使用缓冲读（Buffered Reader）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-12-%E4%BD%BF%E7%94%A8Scanner%E8%AF%BB"><span class="toc-number">3.12.</span> <span class="toc-text">2.12 使用Scanner读</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%BD%92%E6%A1%A3"><span class="toc-number">4.</span> <span class="toc-text">3. 归档</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-Zip%E5%BD%92%E6%A1%A3"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 Zip归档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-Zip%E8%A7%A3%E5%8E%8B"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 Zip解压</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%8E%8B%E7%BC%A9"><span class="toc-number">5.</span> <span class="toc-text">4. 压缩</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 文件压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E6%96%87%E4%BB%B6%E8%A7%A3%E5%8E%8B%E7%BC%A9"><span class="toc-number">5.2.</span> <span class="toc-text">4.1 文件解压缩</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C"><span class="toc-number">6.</span> <span class="toc-text">5. 其他操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95"><span class="toc-number">6.1.</span> <span class="toc-text">5.1 临时文件和目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E4%BB%8EHTTP%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6"><span class="toc-number">6.2.</span> <span class="toc-text">5.2 从HTTP下载文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E5%93%88%E5%B8%8C%E5%92%8C%E6%91%98%E8%A6%81%EF%BC%88Hashing%E5%92%8CChecksums%EF%BC%89"><span class="toc-number">6.3.</span> <span class="toc-text">5.3 哈希和摘要（Hashing和Checksums）</span></a></li></ol></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-使用Go操作文件" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      使用Go操作文件
    </h1>
  


      
      <div class="article-meta">
        
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2022/03/14/%E4%BD%BF%E7%94%A8Go%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/" class="article-date">
	  <time datetime="2022-03-14T12:11:25.000Z" itemprop="datePublished">2022-03-14</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/%E5%8D%9A%E6%96%87/">博文</a>►<a class="article-category-link" href="/categories/%E5%8D%9A%E6%96%87/%E7%AC%94%E8%AE%B0/">笔记</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/Docker/" rel="tag">Docker</a>, <a class="article-tag-link-link" href="/tags/Linux/" rel="tag">Linux</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2022/03/14/%E4%BD%BF%E7%94%A8Go%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1 id="一切皆文件"><a href="#一切皆文件" class="headerlink" title="一切皆文件"></a>一切皆文件</h1><p>UNIX世界的一个基石观点是一切皆文件。我们不需要知道文件描述符映射的，由操作系统的设备驱动抽象出来的是什么。操作系统以文件的形式向我们提供了访问设备的接口。</p>
<p>Go语言中的读/写接口也类似。我们仅仅简单的读/写字节，并不需要理解reader从何处及如何读数据，或者writer将数据写入到了何处。在<code>/dev</code>下能找到可用的设备。有些可能需要提权访问。<br><img src="/images/golang/go_files.png"></p>
<h1 id="1-基础文件操作"><a href="#1-基础文件操作" class="headerlink" title="1. 基础文件操作"></a>1. 基础文件操作</h1><h2 id="1-1-创建空文件"><a href="#1-1-创建空文件" class="headerlink" title="1.1 创建空文件"></a>1.1 创建空文件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-keyword">var</span> (<br>    newFile *os.File<br>    err     <span class="hljs-type">error</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    newFile, err = os.Create(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Println(newFile)<br>    newFile.Close()<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-2-截断文件（Truncate）"><a href="#1-2-截断文件（Truncate）" class="headerlink" title="1.2 截断文件（Truncate）"></a>1.2 截断文件（Truncate）</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// 截断文件至100字节。如果文件小于100字节，则原始内容保留在前并在其后补null字节。</span><br>    <span class="hljs-comment">// 如果文件大于100字节，超过100字节的不删将丢弃。</span><br>    <span class="hljs-comment">// 那么不论哪种情况，我们都将得到长度为100字节的内容。</span><br>    <span class="hljs-comment">// 第二个参数传0，则将清空整个文件。</span><br><br>    err := os.Truncate(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-number">100</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-3-获取文件信息"><a href="#1-3-获取文件信息" class="headerlink" title="1.3 获取文件信息"></a>1.3 获取文件信息</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-keyword">var</span> (<br>    fileInfo os.FileInfo<br>    err      <span class="hljs-type">error</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Stat returns file info. It will return</span><br>    <span class="hljs-comment">// an error if there is no file.</span><br>    fileInfo, err = os.Stat(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Println(<span class="hljs-string">&quot;File name:&quot;</span>, fileInfo.Name()) <span class="hljs-comment">// File name: test.txt</span><br>    fmt.Println(<span class="hljs-string">&quot;Size in bytes:&quot;</span>, fileInfo.Size()) <span class="hljs-comment">// Size in bytes: 12</span><br>    fmt.Println(<span class="hljs-string">&quot;Permissions:&quot;</span>, fileInfo.Mode()) <span class="hljs-comment">// Permissions: -rw-r--r--</span><br>    fmt.Println(<span class="hljs-string">&quot;Last modified:&quot;</span>, fileInfo.ModTime()) <span class="hljs-comment">// Last modified: 2022-03-14 20:42:22.440137408 +0800 CST</span><br>    fmt.Println(<span class="hljs-string">&quot;Is Directory: &quot;</span>, fileInfo.IsDir()) <span class="hljs-comment">// Is Directory:  false</span><br>    fmt.Printf(<span class="hljs-string">&quot;System interface type: %T\n&quot;</span>, fileInfo.Sys()) <span class="hljs-comment">// System interface type: *syscall.Stat_t</span><br>    fmt.Printf(<span class="hljs-string">&quot;System info: %+v\n\n&quot;</span>, fileInfo.Sys()) <span class="hljs-comment">// System info: &amp;&#123;Dev:66306 Ino:11021648 ......</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-4-重命名-移动文件"><a href="#1-4-重命名-移动文件" class="headerlink" title="1.4 重命名/移动文件"></a>1.4 重命名/移动文件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    originalPath := <span class="hljs-string">&quot;test.txt&quot;</span><br>    newPath := <span class="hljs-string">&quot;test2.txt&quot;</span><br>    err := os.Rename(originalPath, newPath)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-5-删除文件"><a href="#1-5-删除文件" class="headerlink" title="1.5 删除文件"></a>1.5 删除文件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    err := os.Remove(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-6-打开-关闭文件"><a href="#1-6-打开-关闭文件" class="headerlink" title="## 1.6 打开/关闭文件"></a>## 1.6 打开/关闭文件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Simple read only open. We will cover actually reading</span><br>    <span class="hljs-comment">// and writing to files in examples further down the page</span><br>    file, err := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    file.Close()<br><br>    <span class="hljs-comment">// OpenFile with more options. Last param is the permission mode</span><br>    <span class="hljs-comment">// Second param is the attributes when opening</span><br>    file, err = os.OpenFile(<span class="hljs-string">&quot;test.txt&quot;</span>, os.O_APPEND, <span class="hljs-number">0666</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    file.Close()<br><br>    <span class="hljs-comment">// Use these attributes individually or combined</span><br>    <span class="hljs-comment">// with an OR for second arg of OpenFile()</span><br>    <span class="hljs-comment">// e.g. os.O_CREATE|os.O_APPEND</span><br>    <span class="hljs-comment">// or os.O_CREATE|os.O_TRUNC|os.O_WRONLY</span><br><br>    <span class="hljs-comment">// os.O_RDONLY // Read only</span><br>    <span class="hljs-comment">// os.O_WRONLY // Write only</span><br>    <span class="hljs-comment">// os.O_RDWR // Read and write</span><br>    <span class="hljs-comment">// os.O_APPEND // Append to end of file</span><br>    <span class="hljs-comment">// os.O_CREATE // Create is none exist</span><br>    <span class="hljs-comment">// os.O_TRUNC // Truncate file when opening</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-7-检查文件是否存在"><a href="#1-7-检查文件是否存在" class="headerlink" title="1.7 检查文件是否存在"></a>1.7 检查文件是否存在</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-keyword">var</span> (<br>    fileInfo *os.FileInfo<br>    err      <span class="hljs-type">error</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Stat returns file info. It will return</span><br>    <span class="hljs-comment">// an error if there is no file.</span><br>    fileInfo, err := os.Stat(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        <span class="hljs-keyword">if</span> os.IsNotExist(err) &#123;<br>            log.Fatal(<span class="hljs-string">&quot;File does not exist.&quot;</span>)<br>        &#125;<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;File does exist. File information:\n%s&quot;</span>, fileInfo)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-8-检查读-写权限"><a href="#1-8-检查读-写权限" class="headerlink" title="1.8 检查读/写权限"></a>1.8 检查读/写权限</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Test write permissions. It is possible the file</span><br>    <span class="hljs-comment">// does not exist and that will return a different</span><br>    <span class="hljs-comment">// error that can be checked with os.IsNotExist(err)</span><br>    file, err := os.OpenFile(<span class="hljs-string">&quot;test.txt&quot;</span>, os.O_WRONLY, <span class="hljs-number">0666</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        <span class="hljs-keyword">if</span> os.IsPermission(err) &#123;<br>            log.Println(<span class="hljs-string">&quot;Error: Write permission denied.&quot;</span>)<br>        &#125;<br>    &#125;<br>    file.Close()<br><br>    <span class="hljs-comment">// Test read permissions</span><br>    file, err = os.OpenFile(<span class="hljs-string">&quot;test.txt&quot;</span>, os.O_RDONLY, <span class="hljs-number">0666</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        <span class="hljs-keyword">if</span> os.IsPermission(err) &#123;<br>            log.Println(<span class="hljs-string">&quot;Error: Read permission denied.&quot;</span>)<br>        &#125;<br>    &#125;<br>    file.Close()<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-9-修改权限-拥有者-时间戳"><a href="#1-9-修改权限-拥有者-时间戳" class="headerlink" title="1.9 修改权限/拥有者/时间戳"></a>1.9 修改权限/拥有者/时间戳</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Change perrmissions using Linux style</span><br>    err := os.Chmod(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-number">0777</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Println(err)<br>    &#125;<br><br>    <span class="hljs-comment">// Change ownership</span><br>    err = os.Chown(<span class="hljs-string">&quot;test.txt&quot;</span>, os.Getuid(), os.Getgid())<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Println(err)<br>    &#125;<br><br>    <span class="hljs-comment">// Change timestamps</span><br>    twoDaysFromNow := time.Now().Add(<span class="hljs-number">48</span> * time.Hour)<br>    lastAccessTime := twoDaysFromNow<br>    lastModifyTime := twoDaysFromNow<br>    err = os.Chtimes(<span class="hljs-string">&quot;test.txt&quot;</span>, lastAccessTime, lastModifyTime)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Println(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-10-创建硬链接-软链接"><a href="#1-10-创建硬链接-软链接" class="headerlink" title="1.10 创建硬链接/软链接"></a>1.10 创建硬链接/软链接</h2><p>典型的文件就是一个指向硬盘某个位置的指针，我们称之为<code>inode</code>。硬链接会创建一个新的指针，指向相同的位置。只有当所有链接都删除时，文件才会真的被从硬盘上物理删除。硬链接只能在相同的文件系统中创建。<br>符号链接或软链接，稍有不同，它并不直接指向磁盘上的位置。软链接仅仅通过文件名引用其他文件。它可以指向不同的文件系统上的文件。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;fmt&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Create a hard link</span><br>    <span class="hljs-comment">// You will have two file names that point to the same contents</span><br>    <span class="hljs-comment">// Changing the contents of one will change the other</span><br>    <span class="hljs-comment">// Deleting/renaming one will not affect the other</span><br>    err := os.Link(<span class="hljs-string">&quot;original.txt&quot;</span>, <span class="hljs-string">&quot;original_also.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>fmt.Println(<span class="hljs-string">&quot;creating sym&quot;</span>)<br>    <span class="hljs-comment">// Create a symlink</span><br>    err = os.Symlink(<span class="hljs-string">&quot;original.txt&quot;</span>, <span class="hljs-string">&quot;original_sym.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    <span class="hljs-comment">// Lstat will return file info, but if it is actually</span><br>    <span class="hljs-comment">// a symlink, it will return info about the symlink.</span><br>    <span class="hljs-comment">// It will not follow the link and give information</span><br>    <span class="hljs-comment">// about the real file</span><br>    <span class="hljs-comment">// Symlinks do not work in Windows</span><br>    fileInfo, err := os.Lstat(<span class="hljs-string">&quot;original_sym.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Printf(<span class="hljs-string">&quot;Link info: %+v&quot;</span>, fileInfo)<br><br>    <span class="hljs-comment">// Change ownership of a symlink only </span><br>    <span class="hljs-comment">// and not the file it points to</span><br>    err = os.Lchown(<span class="hljs-string">&quot;original_sym.txt&quot;</span>, os.Getuid(), os.Getgid())<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="读-写文件"><a href="#读-写文件" class="headerlink" title="读/写文件"></a>读/写文件</h1><h2 id="2-1-复制文件"><a href="#2-1-复制文件" class="headerlink" title="2.1 复制文件"></a>2.1 复制文件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;io&quot;</span><br>)<br><br><span class="hljs-comment">// Copy a file</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open original file</span><br>    originalFile, err := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> originalFile.Close()<br><br>    <span class="hljs-comment">// Create new file</span><br>    newFile, err := os.Create(<span class="hljs-string">&quot;test_copy.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> newFile.Close()<br><br>    <span class="hljs-comment">// Copy the bytes to destination from source</span><br>    bytesWritten, err := io.Copy(newFile, originalFile)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Copied %d bytes.&quot;</span>, bytesWritten)<br>    <br>    <span class="hljs-comment">// Commit the file contents</span><br>    <span class="hljs-comment">// Flushes memory to disk</span><br>    err = newFile.Sync()<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-2-跳至指定位置（Seek）"><a href="#2-2-跳至指定位置（Seek）" class="headerlink" title="2.2 跳至指定位置（Seek）"></a>2.2 跳至指定位置（Seek）</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    file, _ := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">defer</span> file.Close()<br><br>    <span class="hljs-comment">// Offset is how many bytes to move</span><br>    <span class="hljs-comment">// Offset can be positive or negative</span><br>    <span class="hljs-keyword">var</span> offset <span class="hljs-type">int64</span> = <span class="hljs-number">5</span><br><br>    <span class="hljs-comment">// Whence is the point of reference for offset</span><br>    <span class="hljs-comment">// 0 = Beginning of file</span><br>    <span class="hljs-comment">// 1 = Current position</span><br>    <span class="hljs-comment">// 2 = End of file</span><br>    <span class="hljs-keyword">var</span> whence <span class="hljs-type">int</span> = <span class="hljs-number">0</span><br>    newPosition, err := file.Seek(offset, whence)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Println(<span class="hljs-string">&quot;Just moved to 5:&quot;</span>, newPosition)<br><br>    <span class="hljs-comment">// Go back 2 bytes from current position</span><br>    newPosition, err = file.Seek(<span class="hljs-number">-2</span>, <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Println(<span class="hljs-string">&quot;Just moved back two:&quot;</span>, newPosition)<br><br>    <span class="hljs-comment">// Find the current position by getting the</span><br>    <span class="hljs-comment">// return value from Seek after moving 0 bytes</span><br>    currentPosition, err := file.Seek(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>    fmt.Println(<span class="hljs-string">&quot;Current position:&quot;</span>, currentPosition)<br><br>    <span class="hljs-comment">// Go to beginning of file</span><br>    newPosition, err = file.Seek(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Println(<span class="hljs-string">&quot;Position after seeking 0,0:&quot;</span>, newPosition)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-3-向文件写入字节"><a href="#2-3-向文件写入字节" class="headerlink" title="2.3 向文件写入字节"></a>2.3 向文件写入字节</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open a new file for writing only</span><br>    file, err := os.OpenFile(<br>        <span class="hljs-string">&quot;test.txt&quot;</span>,<br>        os.O_WRONLY|os.O_TRUNC|os.O_CREATE,<br>        <span class="hljs-number">0666</span>,<br>    )<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> file.Close()<br><br>    <span class="hljs-comment">// Write bytes to file</span><br>    byteSlice := []<span class="hljs-type">byte</span>(<span class="hljs-string">&quot;Bytes!\n&quot;</span>)<br>    bytesWritten, err := file.Write(byteSlice)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Wrote %d bytes.\n&quot;</span>, bytesWritten)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-4-快速写入文件"><a href="#2-4-快速写入文件" class="headerlink" title="2.4 快速写入文件"></a>2.4 快速写入文件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;io/ioutil&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    err := ioutil.WriteFile(<span class="hljs-string">&quot;test.txt&quot;</span>, []<span class="hljs-type">byte</span>(<span class="hljs-string">&quot;Hi\n&quot;</span>), <span class="hljs-number">0666</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-5-使用缓冲写（Buffered-Writer）"><a href="#2-5-使用缓冲写（Buffered-Writer）" class="headerlink" title="2.5 使用缓冲写（Buffered Writer）"></a>2.5 使用缓冲写（Buffered Writer）</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;bufio&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open file for writing</span><br>    file, err := os.OpenFile(<span class="hljs-string">&quot;test.txt&quot;</span>, os.O_WRONLY, <span class="hljs-number">0666</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> file.Close()<br><br>    <span class="hljs-comment">// Create a buffered writer from the file</span><br>    bufferedWriter := bufio.NewWriter(file)<br><br>    <span class="hljs-comment">// Write bytes to buffer</span><br>    bytesWritten, err := bufferedWriter.Write(<br>        []<span class="hljs-type">byte</span>&#123;<span class="hljs-number">65</span>, <span class="hljs-number">66</span>, <span class="hljs-number">67</span>&#125;,<br>    )<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Bytes written: %d\n&quot;</span>, bytesWritten)<br><br>    <span class="hljs-comment">// Write string to buffer</span><br>    <span class="hljs-comment">// Also available are WriteRune() and WriteByte()   </span><br>    bytesWritten, err = bufferedWriter.WriteString(<br>        <span class="hljs-string">&quot;Buffered string\n&quot;</span>,<br>    )<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Bytes written: %d\n&quot;</span>, bytesWritten)<br><br>    <span class="hljs-comment">// Check how much is stored in buffer waiting</span><br>    unflushedBufferSize := bufferedWriter.Buffered()<br>    log.Printf(<span class="hljs-string">&quot;Bytes buffered: %d\n&quot;</span>, unflushedBufferSize)<br><br>    <span class="hljs-comment">// See how much buffer is available</span><br>    bytesAvailable := bufferedWriter.Available()<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Available buffer: %d\n&quot;</span>, bytesAvailable)<br><br>    <span class="hljs-comment">// Write memory buffer to disk</span><br>    bufferedWriter.Flush()<br><br>    <span class="hljs-comment">// Revert any changes done to buffer that have</span><br>    <span class="hljs-comment">// not yet been written to file with Flush()</span><br>    <span class="hljs-comment">// We just flushed, so there are no changes to revert</span><br>    <span class="hljs-comment">// The writer that you pass as an argument</span><br>    <span class="hljs-comment">// is where the buffer will output to, if you want</span><br>    <span class="hljs-comment">// to change to a new writer</span><br>    bufferedWriter.Reset(bufferedWriter) <br><br>    <span class="hljs-comment">// See how much buffer is available</span><br>    bytesAvailable = bufferedWriter.Available()<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Available buffer: %d\n&quot;</span>, bytesAvailable)<br><br>    <span class="hljs-comment">// Resize buffer. The first argument is a writer</span><br>    <span class="hljs-comment">// where the buffer should output to. In this case</span><br>    <span class="hljs-comment">// we are using the same buffer. If we chose a number</span><br>    <span class="hljs-comment">// that was smaller than the existing buffer, like 10</span><br>    <span class="hljs-comment">// we would not get back a buffer of size 10, we will</span><br>    <span class="hljs-comment">// get back a buffer the size of the original since</span><br>    <span class="hljs-comment">// it was already large enough (default 4096)</span><br>    bufferedWriter = bufio.NewWriterSize(<br>        bufferedWriter,<br>        <span class="hljs-number">8000</span>,<br>    )<br><br>    <span class="hljs-comment">// Check available buffer size after resizing</span><br>    bytesAvailable = bufferedWriter.Available()<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Available buffer: %d\n&quot;</span>, bytesAvailable)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="最多读文件的n个字节"><a href="#最多读文件的n个字节" class="headerlink" title="最多读文件的n个字节"></a>最多读文件的n个字节</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open file for reading</span><br>    file, err := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> file.Close()<br><br>    <span class="hljs-comment">// Read up to len(b) bytes from the File</span><br>    <span class="hljs-comment">// Zero bytes written means end of file</span><br>    <span class="hljs-comment">// End of file returns error type io.EOF</span><br>    byteSlice := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-number">16</span>)<br>    bytesRead, err := file.Read(byteSlice)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Number of bytes read: %d\n&quot;</span>, bytesRead)<br>    log.Printf(<span class="hljs-string">&quot;Data read: %s\n&quot;</span>, byteSlice)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-7-只读取文件的n个字节"><a href="#2-7-只读取文件的n个字节" class="headerlink" title="2.7 只读取文件的n个字节"></a>2.7 只读取文件的n个字节</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;io&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open file for reading</span><br>    file, err := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    <span class="hljs-comment">// The file.Read() function will happily read a tiny file in to a large</span><br>    <span class="hljs-comment">// byte slice, but io.ReadFull() will return an</span><br>    <span class="hljs-comment">// error if the file is smaller than the byte slice.</span><br>    byteSlice := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-number">2</span>)<br>    numBytesRead, err := io.ReadFull(file, byteSlice)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Number of bytes read: %d\n&quot;</span>, numBytesRead)<br>    log.Printf(<span class="hljs-string">&quot;Data read: %s\n&quot;</span>, byteSlice)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-8-至少读取文件的n个字节"><a href="#2-8-至少读取文件的n个字节" class="headerlink" title="2.8 至少读取文件的n个字节"></a>2.8 至少读取文件的n个字节</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;io&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open file for reading</span><br>    file, err := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    byteSlice := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-number">512</span>)<br>    minBytes := <span class="hljs-number">8</span><br>    <span class="hljs-comment">// io.ReadAtLeast() will return an error if it cannot</span><br>    <span class="hljs-comment">// find at least minBytes to read. It will read as</span><br>    <span class="hljs-comment">// many bytes as byteSlice can hold. </span><br>    numBytesRead, err := io.ReadAtLeast(file, byteSlice, minBytes)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    log.Printf(<span class="hljs-string">&quot;Number of bytes read: %d\n&quot;</span>, numBytesRead)<br>    log.Printf(<span class="hljs-string">&quot;Data read: %s\n&quot;</span>, byteSlice)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-9-读文件的全部字节"><a href="#2-9-读文件的全部字节" class="headerlink" title="2.9 读文件的全部字节"></a>2.9 读文件的全部字节</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;io/ioutil&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open file for reading</span><br>    file, err := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    <span class="hljs-comment">// os.File.Read(), io.ReadFull(), and</span><br>    <span class="hljs-comment">// io.ReadAtLeast() all work with a fixed</span><br>    <span class="hljs-comment">// byte slice that you make before you read</span><br><br>    <span class="hljs-comment">// ioutil.ReadAll() will read every byte</span><br>    <span class="hljs-comment">// from the reader (in this case a file),</span><br>    <span class="hljs-comment">// and return a slice of unknown slice</span><br>    data, err := ioutil.ReadAll(file)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    fmt.Printf(<span class="hljs-string">&quot;Data as hex: %x\n&quot;</span>, data)<br>    fmt.Printf(<span class="hljs-string">&quot;Data as string: %s\n&quot;</span>, data)<br>    fmt.Println(<span class="hljs-string">&quot;Number of bytes read:&quot;</span>, <span class="hljs-built_in">len</span>(data))<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-10-快速读取全部文件到内存"><a href="#2-10-快速读取全部文件到内存" class="headerlink" title="2.10 快速读取全部文件到内存"></a>2.10 快速读取全部文件到内存</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;io/ioutil&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Read file to byte slice</span><br>    data, err := ioutil.ReadFile(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    log.Printf(<span class="hljs-string">&quot;Data read: %s\n&quot;</span>, data)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-11-使用缓冲读（Buffered-Reader）"><a href="#2-11-使用缓冲读（Buffered-Reader）" class="headerlink" title="2.11 使用缓冲读（Buffered Reader）"></a>2.11 使用缓冲读（Buffered Reader）</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;bufio&quot;</span><br>    <span class="hljs-string">&quot;fmt&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open file and create a buffered reader on top</span><br>    file, err := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    bufferedReader := bufio.NewReader(file)<br><br>    <span class="hljs-comment">// Get bytes without advancing pointer</span><br>    byteSlice := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-number">5</span>)<br>    byteSlice, err = bufferedReader.Peek(<span class="hljs-number">5</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Printf(<span class="hljs-string">&quot;Peeked at 5 bytes: %s\n&quot;</span>, byteSlice)<br><br>    <span class="hljs-comment">// Read and advance pointer</span><br>    numBytesRead, err := bufferedReader.Read(byteSlice)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Printf(<span class="hljs-string">&quot;Read %d bytes: %s\n&quot;</span>, numBytesRead, byteSlice)<br><br>    <span class="hljs-comment">// Ready 1 byte. Error if no byte to read</span><br>    myByte, err := bufferedReader.ReadByte()<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Printf(<span class="hljs-string">&quot;Read 1 byte: %c\n&quot;</span>, myByte)     <br><br>    <span class="hljs-comment">// Read up to and including delimiter</span><br>    <span class="hljs-comment">// Returns byte slice</span><br>    dataBytes, err := bufferedReader.ReadBytes(<span class="hljs-string">&#x27;\n&#x27;</span>) <br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Printf(<span class="hljs-string">&quot;Read bytes: %s\n&quot;</span>, dataBytes)           <br><br>    <span class="hljs-comment">// Read up to and including delimiter</span><br>    <span class="hljs-comment">// Returns string   </span><br>    dataString, err := bufferedReader.ReadString(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    fmt.Printf(<span class="hljs-string">&quot;Read string: %s\n&quot;</span>, dataString)     <br><br>    <span class="hljs-comment">// This example reads a few lines so test.txt</span><br>    <span class="hljs-comment">// should have a few lines of text to work correct</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-12-使用Scanner读"><a href="#2-12-使用Scanner读" class="headerlink" title="2.12 使用Scanner读"></a>2.12 使用Scanner读</h2><p><code>bufio</code>包有一个<code>Scanner</code>，它提供了一种方法使用指定的分隔符来逐项迭代文件内容。默认情况下，使用换行符<code>newline</code>来将文件拆分为若干行。在CSV文件中，使用逗号作为分隔符。<code>os.File</code>对象可以使用<code>bufio.Scanner</code>包装，用起来和缓存读相似。调用<code>Scan</code>函数读取下一行，调用<code>Text()</code>或<code>Bytes()</code>读取内容。<br>分隔符不是一个简单的字节或字符，有一个特殊的函数用来决定符合分隔，计算从何处开始算作下一行，指针向前移动多少，返回什么数据。若未提供自定义的<code>SplitFunc</code>函数，默认使用<code>ScanLines</code>函数。另外<code>bufio</code>包提供了<code>ScanRunes</code>和<code>ScanWords</code>函数。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;bufio&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open file and create scanner on top of it</span><br>    file, err := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    scanner := bufio.NewScanner(file)<br><br>    <span class="hljs-comment">// Default scanner is bufio.ScanLines. Lets use ScanWords.</span><br>    <span class="hljs-comment">// Could also use a custom function of SplitFunc type</span><br>    scanner.Split(bufio.ScanWords)<br><br>    <span class="hljs-comment">// Scan for next token. </span><br>    success := scanner.Scan() <br>    <span class="hljs-keyword">if</span> success == <span class="hljs-literal">false</span> &#123;<br>        <span class="hljs-comment">// False on error or EOF. Check error</span><br>        err = scanner.Err()<br>        <span class="hljs-keyword">if</span> err == <span class="hljs-literal">nil</span> &#123;<br>            log.Println(<span class="hljs-string">&quot;Scan completed and reached EOF&quot;</span>)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            log.Fatal(err)<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// Get data from scan with Bytes() or Text()</span><br>    fmt.Println(<span class="hljs-string">&quot;First word found:&quot;</span>, scanner.Text())<br><br>    <span class="hljs-comment">// Call scanner.Scan() again to find next token</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="3-归档"><a href="#3-归档" class="headerlink" title="3. 归档"></a>3. 归档</h1><h2 id="3-1-Zip归档"><a href="#3-1-Zip归档" class="headerlink" title="3.1 Zip归档"></a>3.1 Zip归档</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// This example uses zip but standard library</span><br><span class="hljs-comment">// also supports tar archives</span><br><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;archive/zip&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Create a file to write the archive buffer to</span><br>    <span class="hljs-comment">// Could also use an in memory buffer.</span><br>    outFile, err := os.Create(<span class="hljs-string">&quot;test.zip&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> outFile.Close()<br><br>    <span class="hljs-comment">// Create a zip writer on top of the file writer</span><br>    zipWriter := zip.NewWriter(outFile)<br><br><br>    <span class="hljs-comment">// Add files to archive</span><br>    <span class="hljs-comment">// We use some hard coded data to demonstrate,</span><br>    <span class="hljs-comment">// but you could iterate through all the files</span><br>    <span class="hljs-comment">// in a directory and pass the name and contents</span><br>    <span class="hljs-comment">// of each file, or you can take data from your</span><br>    <span class="hljs-comment">// program and write it write in to the archive</span><br>    <span class="hljs-comment">// without </span><br>    <span class="hljs-keyword">var</span> filesToArchive = []<span class="hljs-keyword">struct</span> &#123;<br>        Name, Body <span class="hljs-type">string</span><br>    &#125; &#123;<br>        &#123;<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;String contents of file&quot;</span>&#125;,<br>        &#123;<span class="hljs-string">&quot;test2.txt&quot;</span>, <span class="hljs-string">&quot;\x61\x62\x63\n&quot;</span>&#125;,<br>    &#125;<br><br>    <span class="hljs-comment">// Create and write files to the archive, which in turn</span><br>    <span class="hljs-comment">// are getting written to the underlying writer to the</span><br>    <span class="hljs-comment">// .zip file we created at the beginning</span><br>    <span class="hljs-keyword">for</span> _, file := <span class="hljs-keyword">range</span> filesToArchive &#123;<br>            fileWriter, err := zipWriter.Create(file.Name)<br>            <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>                    log.Fatal(err)<br>            &#125;<br>            _, err = fileWriter.Write([]<span class="hljs-type">byte</span>(file.Body))<br>            <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>                    log.Fatal(err)<br>            &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// Clean up</span><br>    err = zipWriter.Close()<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>            log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="3-2-Zip解压"><a href="#3-2-Zip解压" class="headerlink" title="3.2 Zip解压"></a>3.2 Zip解压</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// This example uses zip but standard library</span><br><span class="hljs-comment">// also supports tar archives</span><br><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;archive/zip&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;io&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;path/filepath&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Create a reader out of the zip archive</span><br>    zipReader, err := zip.OpenReader(<span class="hljs-string">&quot;test.zip&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> zipReader.Close()<br><br>    <span class="hljs-comment">// Iterate through each file/dir found in</span><br>    <span class="hljs-keyword">for</span> _, file := <span class="hljs-keyword">range</span> zipReader.Reader.File &#123;<br>        <span class="hljs-comment">// Open the file inside the zip archive</span><br>        <span class="hljs-comment">// like a normal file</span><br>        zippedFile, err := file.Open()<br>        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>            log.Fatal(err)<br>        &#125;<br>        <span class="hljs-keyword">defer</span> zippedFile.Close()<br>        <br>        <span class="hljs-comment">// Specify what the extracted file name should be.</span><br>        <span class="hljs-comment">// You can specify a full path or a prefix</span><br>        <span class="hljs-comment">// to move it to a different directory. </span><br>        <span class="hljs-comment">// In this case, we will extract the file from</span><br>        <span class="hljs-comment">// the zip to a file of the same name.</span><br>        targetDir := <span class="hljs-string">&quot;./&quot;</span><br>        extractedFilePath := filepath.Join(<br>            targetDir,<br>            file.Name,<br>        )<br><br>        <span class="hljs-comment">// Extract the item (or create directory)</span><br>        <span class="hljs-keyword">if</span> file.FileInfo().IsDir() &#123;<br>            <span class="hljs-comment">// Create directories to recreate directory</span><br>            <span class="hljs-comment">// structure inside the zip archive. Also</span><br>            <span class="hljs-comment">// preserves permissions</span><br>            log.Println(<span class="hljs-string">&quot;Creating directory:&quot;</span>, extractedFilePath)<br>            os.MkdirAll(extractedFilePath, file.Mode())<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// Extract regular file since not a directory</span><br>            log.Println(<span class="hljs-string">&quot;Extracting file:&quot;</span>, file.Name)<br><br>            <span class="hljs-comment">// Open an output file for writing</span><br>            outputFile, err := os.OpenFile(<br>                extractedFilePath,<br>                os.O_WRONLY|os.O_CREATE|os.O_TRUNC,<br>                file.Mode(),<br>            )<br>            <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>                log.Fatal(err)<br>            &#125;<br>            <span class="hljs-keyword">defer</span> outputFile.Close()<br><br>            <span class="hljs-comment">// &quot;Extract&quot; the file by copying zipped file</span><br>            <span class="hljs-comment">// contents to the output file</span><br>            _, err = io.Copy(outputFile, zippedFile)<br>            <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>                log.Fatal(err)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="4-压缩"><a href="#4-压缩" class="headerlink" title="4. 压缩"></a>4. 压缩</h1><h2 id="4-1-文件压缩"><a href="#4-1-文件压缩" class="headerlink" title="4.1 文件压缩"></a>4.1 文件压缩</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// This example uses gzip but standard library also</span><br><span class="hljs-comment">// supports zlib, bz2, flate, and lzw</span><br><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;os&quot;</span><br>    <span class="hljs-string">&quot;compress/gzip&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Create .gz file to write to</span><br>    outputFile, err := os.Create(<span class="hljs-string">&quot;test.txt.gz&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    <span class="hljs-comment">// Create a gzip writer on top of file writer</span><br>    gzipWriter := gzip.NewWriter(outputFile)<br>    <span class="hljs-keyword">defer</span> gzipWriter.Close()<br><br>    <span class="hljs-comment">// When we write to the gzip writer</span><br>    <span class="hljs-comment">// it will in turn compress the contents</span><br>    <span class="hljs-comment">// and then write it to the underlying</span><br>    <span class="hljs-comment">// file writer as well</span><br>    <span class="hljs-comment">// We don&#x27;t have to worry about how all</span><br>    <span class="hljs-comment">// the compression works since we just</span><br>    <span class="hljs-comment">// use it as a simple writer interface</span><br>    <span class="hljs-comment">// that we send bytes to</span><br>    _, err = gzipWriter.Write([]<span class="hljs-type">byte</span>(<span class="hljs-string">&quot;Gophers rule!\n&quot;</span>))<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    log.Println(<span class="hljs-string">&quot;Compressed data written to file.&quot;</span>) <br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-1-文件解压缩"><a href="#4-1-文件解压缩" class="headerlink" title="4.1 文件解压缩"></a>4.1 文件解压缩</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// This example uses gzip but standard library also</span><br><span class="hljs-comment">// supports zlib, bz2, flate, and lzw</span><br><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;compress/gzip&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;io&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open gzip file that we want to uncompress</span><br>    <span class="hljs-comment">// The file is a reader, but we could use any</span><br>    <span class="hljs-comment">// data source. It is common for web servers</span><br>    <span class="hljs-comment">// to return gzipped contents to save bandwidth</span><br>    <span class="hljs-comment">// and in that case the data is not in a file</span><br>    <span class="hljs-comment">// on the file system but is in a memory buffer</span><br>    gzipFile, err := os.Open(<span class="hljs-string">&quot;test.txt.gz&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    <span class="hljs-comment">// Create a gzip reader on top of the file reader</span><br>    <span class="hljs-comment">// Again, it could be any type reader though</span><br>    gzipReader, err := gzip.NewReader(gzipFile)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> gzipReader.Close()<br><br>    <span class="hljs-comment">// Uncompress to a writer. We&#x27;ll use a file writer</span><br>    outfileWriter, err := os.Create(<span class="hljs-string">&quot;unzipped.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> outfileWriter.Close()<br><br>    <span class="hljs-comment">// Copy contents of gzipped file to output file</span><br>    _, err = io.Copy(outfileWriter, gzipReader)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="5-其他操作"><a href="#5-其他操作" class="headerlink" title="5. 其他操作"></a>5. 其他操作</h1><h2 id="5-1-临时文件和目录"><a href="#5-1-临时文件和目录" class="headerlink" title="5.1 临时文件和目录"></a>5.1 临时文件和目录</h2><p><code>ioutil</code>包提提供了两个函数<code>TempDir()</code>和<code>TempFile()</code>。使用完毕后，调用方需要负责主动删除临时文件。这两个函数唯一提供的一项便利是在传空参数时，它会在系统的<code>/tmp</code>目录下自动创建。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>     <span class="hljs-string">&quot;os&quot;</span><br>     <span class="hljs-string">&quot;io/ioutil&quot;</span><br>     <span class="hljs-string">&quot;log&quot;</span><br>     <span class="hljs-string">&quot;fmt&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>     <span class="hljs-comment">// Create a temp dir in the system default temp folder</span><br>     tempDirPath, err := ioutil.TempDir(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;myTempDir&quot;</span>)<br>     <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>          log.Fatal(err)<br>     &#125;<br>     fmt.Println(<span class="hljs-string">&quot;Temp dir created:&quot;</span>, tempDirPath)<br><br>     <span class="hljs-comment">// Create a file in new temp directory</span><br>     tempFile, err := ioutil.TempFile(tempDirPath, <span class="hljs-string">&quot;myTempFile.txt&quot;</span>)<br>     <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>          log.Fatal(err)<br>     &#125;<br>     fmt.Println(<span class="hljs-string">&quot;Temp file created:&quot;</span>, tempFile.Name())<br>     <br>     <span class="hljs-comment">// ... do something with temp file/dir ...</span><br><br>     <span class="hljs-comment">// Close file</span><br>     err = tempFile.Close()<br>     <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    <span class="hljs-comment">// Delete the resources we created</span><br>     err = os.Remove(tempFile.Name())<br>     <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>     err = os.Remove(tempDirPath)<br>     <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="5-2-从HTTP下载文件"><a href="#5-2-从HTTP下载文件" class="headerlink" title="5.2 从HTTP下载文件"></a>5.2 从HTTP下载文件</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>     <span class="hljs-string">&quot;os&quot;</span><br>     <span class="hljs-string">&quot;io&quot;</span><br>     <span class="hljs-string">&quot;log&quot;</span><br>     <span class="hljs-string">&quot;net/http&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>     <span class="hljs-comment">// Create output file</span><br>     newFile, err := os.Create(<span class="hljs-string">&quot;devdungeon.html&quot;</span>)<br>     <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>          log.Fatal(err)<br>     &#125;<br>     <span class="hljs-keyword">defer</span> newFile.Close()<br><br>     <span class="hljs-comment">// HTTP GET request devdungeon.com </span><br>     url := <span class="hljs-string">&quot;http://www.devdungeon.com/archive&quot;</span><br>     response, err := http.Get(url)<br>     <span class="hljs-keyword">defer</span> response.Body.Close()<br><br>     <span class="hljs-comment">// Write bytes from HTTP response to file.</span><br>     <span class="hljs-comment">// response.Body satisfies the reader interface.</span><br>     <span class="hljs-comment">// newFile satisfies the writer interface.</span><br>     <span class="hljs-comment">// That allows us to use io.Copy which accepts</span><br>     <span class="hljs-comment">// any type that implements reader and writer interface</span><br>     numBytesWritten, err := io.Copy(newFile, response.Body)<br>     <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>          log.Fatal(err)<br>     &#125;<br>     log.Printf(<span class="hljs-string">&quot;Downloaded %d byte file.\n&quot;</span>, numBytesWritten)<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="5-3-哈希和摘要（Hashing和Checksums）"><a href="#5-3-哈希和摘要（Hashing和Checksums）" class="headerlink" title="5.3 哈希和摘要（Hashing和Checksums）"></a>5.3 哈希和摘要（Hashing和Checksums）</h2><p>示例1</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;crypto/md5&quot;</span><br>    <span class="hljs-string">&quot;crypto/sha1&quot;</span><br>    <span class="hljs-string">&quot;crypto/sha256&quot;</span><br>    <span class="hljs-string">&quot;crypto/sha512&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;io/ioutil&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Get bytes from file</span><br>    data, err := ioutil.ReadFile(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    <span class="hljs-comment">// Hash the file and output results</span><br>    fmt.Printf(<span class="hljs-string">&quot;Md5: %x\n\n&quot;</span>, md5.Sum(data))<br>    fmt.Printf(<span class="hljs-string">&quot;Sha1: %x\n\n&quot;</span>, sha1.Sum(data))<br>    fmt.Printf(<span class="hljs-string">&quot;Sha256: %x\n\n&quot;</span>, sha256.Sum256(data))<br>    fmt.Printf(<span class="hljs-string">&quot;Sha512: %x\n\n&quot;</span>, sha512.Sum512(data))<br>&#125;<br></code></pre></td></tr></table></figure>

<p>示例2</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;crypto/md5&quot;</span><br>    <span class="hljs-string">&quot;log&quot;</span><br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;io&quot;</span><br>    <span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// Open file for reading</span><br>    file, err := os.Open(<span class="hljs-string">&quot;test.txt&quot;</span>)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br>    <span class="hljs-keyword">defer</span> file.Close()<br>    <br>    <span class="hljs-comment">// Create new hasher, which is a writer interface</span><br>    hasher := md5.New()<br>    _, err = io.Copy(hasher, file)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>        log.Fatal(err)<br>    &#125;<br><br>    <span class="hljs-comment">// Hash and print. Pass nil since</span><br>    <span class="hljs-comment">// the data is not coming in as a slice argument</span><br>    <span class="hljs-comment">// but is coming through the writer interface</span><br>    sum := hasher.Sum(<span class="hljs-literal">nil</span>)<br>    fmt.Printf(<span class="hljs-string">&quot;Md5 checksum: %x\n&quot;</span>, sum)<br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<ul>
<li>原文<a target="_blank" rel="noopener" href="https://www.devdungeon.com/content/working-files-go">Working with Files in Go</a></li>
</ul>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://straysh.github.life/2022/03/14/%E4%BD%BF%E7%94%A8Go%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/" title="使用Go操作文件" target="_blank" rel="external">https://straysh.github.life/2022/03/14/%E4%BD%BF%E7%94%A8Go%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://hexo.straysh.com" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://hexo.straysh.com" target="_blank"><span class="text-dark">Straysh</span><small class="ml-1x">野生程序猿</small></a></h3>
        <div>野生程序猿 &amp; 猫奴。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    
    <li class="next">
      <a href="/2022/03/13/Docker%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C/" title="Docker容器网络"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/straysh" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/u/1689171115" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        &copy; 2022 straysh.com 版权所有。ICP证：鄂ICP备2021016952号-1<!--Straysh-->
        
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




<!--   
    
    <script defer>
    var disqus_config = function () {
        
            this.page.url = 'https://straysh.github.life/2022/03/14/%E4%BD%BF%E7%94%A8Go%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6/';
        
        this.page.identifier = '使用Go操作文件';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'straysh' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

-->


<!--  <script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>-->
  <script src="/js/jquery.fancybox.min.js"></script>
  <script>
  //利用 FancyBox 实现点击图片放大
  $(document).ready(function() {
    // $('article img').not('[hidden]').not('.panel-body img').each(function() {
    //   var $image = $(this);
    //   var imageCaption = $image.attr('alt');
    //   var $imageWrapLink = $image.parent('a');
    //   if ($imageWrapLink.length < 1) {
    //     var src = this.getAttribute('src');
    //     var idx = src.lastIndexOf('?');
    //     if (idx != -1) {
    //       src = src.substring(0, idx);
    //     }
    //     $imageWrapLink = $image.wrap('<a href="' + src + '"></a>').parent('a');
    //   }
    //   $imageWrapLink.attr('data-fancybox', 'images');
    //   if (imageCaption) {
    //     $imageWrapLink.attr('data-caption', imageCaption);
    //   }
    // });
    // $().fancybox({
    //   selector: '[data-fancybox="images"]',
    //   hash: false,
    //   loop: false,
    // });

    $('[data-fancybox]').fancybox({
      // afterShow :function() {
      //   $('.fancybox-button--zoom').click();
      // }
    });
  });
  </script>






</body>
</html>
